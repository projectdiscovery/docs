---
title: "Internal Network Vulnerability Scanning"
sidebarTitle: "Internal Scanning"
---

Internal network security is critical yet often overlooked. Once attackers gain initial access through configuration drift, phishing, or compromised credentials, they can rapidly expand their foothold by exploiting internal vulnerabilities. This lateral movement can lead to devastating breaches, making internal vulnerability scanning as crucial as external assessments.

ProjectDiscovery offers two distinct approaches for internal network vulnerability scanning, each designed to fit different organizational needs while maintaining our core focus on exploitability and accurate detection.

<CardGroup cols={2}>
  <Card title="Agent based Scanning" icon="cloud" color="blue">
    Use pd-agent for seamless internal scanning through our platform. Perfect for large networks and centralized security management.
  </Card>
  <Card title="Local Scanning & Upload" icon="upload">
    Run Nuclei locally and upload results to PD's platform. Ideal for teams with existing scanning workflows or specific network restrictions.
  </Card>
</CardGroup>

<Note>
  Internal scanning helps identify misconfigurations, unpatched systems, and security gaps that could be exploited for lateral movement before attackers can leverage them.
</Note>

## Method 1: Agent based Scanning (Recommended)

To use this feature you'll need to install and deploy pd-agent within your internal network. The agent acts as a bridge between your internal infrastructure and ProjectDiscovery's platform, enabling you to trigger and manage scans remotely.

### What is pd-agent?

pd-agent is a lightweight agent that you deploy within your internal network to execute scans and enumerations remotely. It establishes a secure connection between your internal infrastructure and ProjectDiscovery's platform, receives scan configurations and executes them locally using ProjectDiscovery's tools.

**Key Capabilities:**

- **Network Discovery**: Automatically discover assets, services, and open ports across your internal network
- **Vulnerability Scanning**: Execute Nuclei-based vulnerability scans using templates from the ProjectDiscovery's platform  
- **Agent Tagging**: Organize agents with tags and networks for targeted execution
- **Passive Discovery**: Optional passive network discovery via libpcap/gopacket
- **Automatic Updates**: Receive and execute new scan configurations automatically

<Note>
  Agent based internal scanning is an Enterprise-exclusive feature. Free users can still perform internal scans using the local scanning method described below.
</Note>

<Note>
  **System Requirements**\
  The agent is designed to be lightweight and efficient. Minimum recommended specifications for optimal performance:

  - **CPU:** 2 vCPU
  - **Memory:** 4GB RAM
  - **Network:** 100Mbps network interface
  - **Storage:** 10GB available disk space
  - **Operating System:** Linux (recommended), macOS, or Windows

  These specifications are suitable for most deployment scenarios. A basic VPS (Virtual Private Server) meeting these requirements is sufficient for running pd-agent efficiently.
</Note>

### Step 1: Create a Network

Before installing the agent, you need to create a network in the ProjectDiscovery's platform. Each network represents a distinct internal environment (e.g., production, staging, office network) and generates a unique agent configuration.

1. Navigate to [https://cloud.projectdiscovery.io/networks](https://cloud.projectdiscovery.io/networks)
2. Click **"Create Network"**
3. Provide a network name
4. Save the network to generate your unique agent installation command

<Frame>
  <img src="/images/pdcp-create-network-demo.gif" alt="Creating a Network in PDCP" />
</Frame>

<Info>
  You can create multiple networks for different environments or network segments. Each network can have one or more agents deployed.
</Info>

### Step 2: Install the agent

After creating your network, the platform will display a unique installation command pre-configured with your credentials and network settings. Simply copy and run this command in your internal environment where you want the agent deployed.

<Warning>
  Keep your installation command secure - it contains your API key and agent configuration. Anyone with this command can connect an agent to your network.
</Warning>

The installation command will:
- Download and configure the agent
- Establish a secure connection to ProjectDiscovery's platform
- Register the agent with your network

Once the agent runs successfully, it will appear in your network dashboard with a **"Connected"** status, indicating that it's ready to execute scans.

<Frame>
  <img src="/images/pd-agent-setup-demo.gif" alt="Complete pd-agent Setup: Create Network, Install Agent, and Verify Connection" />
</Frame>

<Note>
  The agent must remain running to execute scans. For production deployments, consider running it as a system service (systemd, Docker, or Kubernetes) to ensure it stays active.
</Note>

### Step 3: Trigger Internal Scans

Once your pd-agent is connected, triggering internal scans works identically to external scanning. The workflow is seamless - you configure scans through the same interface and view results in the same dashboard.

1. **Initiate a Scan**:
   - Click on the **Scan** button for the network you want to scan
   - Or go to the **Scans** menu (https://cloud.projectdiscovery.io/scans) and click on **Create New Scan**, choose **Internal** followed by the network you want to scan. Similar to how you would run an external scan

2. **Configure Your Scan**:
   - **Targets**: Enter internal IPs, hostnames, or CIDR ranges (e.g., `192.168.1.0/24`, `internal-server.local`)
   - **Templates**: Select Nuclei templates (CVEs, misconfigurations, vulnerabilities, etc.)
   - **Configuration**: Choose scan settings, rate limits, headers, and other parameters

3. **Launch Your Scan**:
   - Click **"Create Scan"** to start scanning your internal targets
   - The scan executes through pd-agent in your internal network
   - Results appear in your dashboard just like external scans

<Frame>
  <img src="/images/pdcp-internal-scan-demo.gif" alt="Creating and Running an Internal Scan in PDCP" />
</Frame>

<Note>
  Internal scanning provides the same experience as external scanning - identical template selection, scan configuration, results viewing, retesting capabilities, and integration options.
</Note>

<Note>
  **Important:** Only input targets that are accessible from where pd-agent is deployed. If the agent is running on a server in your 192.168.1.0/24 network, it can only scan hosts within that network or other networks it has routing access to.
</Note>

## Method 2: Local Scanning & Upload

This approach lets you run Nuclei locally and upload results to ProjectDiscovery Cloud Platform (ProjectDiscovery).

### Set up your API Key

To connect your existing Nuclei results to PDCP you will need to create a free API Key:

1. Visit https://cloud.projectdiscovery.io
2. Open the setting menu from the top right and select "API Key" to create your API Key

<img
  class="block"
  src="/images/pdcp-api-key.png"
  alt="PDCP API Key"
/>

3. Use the `nuclei -auth` command, and enter your API key when prompted.

### Configure Team (Optional)

If you want to upload the scan results to a team workspace instead of your personal workspace, you can configure the Team ID using either method:

- **Obtain Team ID:**
  - Navigate to https://cloud.projectdiscovery.io/settings/team
  - Copy the Team ID from the top right section

  <img
    class="block"
    src="/images/platform/obtain-team-id.png"
    alt="Obtain Team ID"
  />
- **CLI Option:**

  ```bash
  nuclei -tid XXXXXX -cloud-upload
  ```
- **ENV Variable:**

  ```bash
  export PDCP_TEAM_ID=XXXXX
  ```

2. Run your scan with the upload flag:

```bash
# Single target
nuclei -u http://internal-target -cloud-upload

# Multiple targets
nuclei -l internal-hosts.txt -cloud-upload

# With specific templates
nuclei -u http://internal-target -t misconfiguration/ -cloud-upload
```

<Note>
  This method is ideal when you want to maintain complete control over scan execution or integrate with existing automation scripts.
</Note>